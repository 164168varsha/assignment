db.getCollection('zipcodes').aggregate([{$match:{state:"TX"}},{$group:{_id: "$city",total:{$sum:"$pop"}}},{$sort:{"total":-1}},{$limit:3}])